{"version":3,"sources":["bulk-exporter.js"],"names":["$","document","ready","$iframe","length","click","e","this","prev","val","preventDefault","today","Date","YB2","date","window","prompt","confirm","postIds","find","each","i","input","push","parseInt","endpoint","export","glue","join","nonce","attr","submit","addClass","empty","callback","json","removeClass","error","toggleClass","html","message","$msg","$list","data","li","append","jQuery"],"mappings":"CAMA,SAAWA,GAET,YAEAA,GAAEC,UAAUC,MAAM,WAGhB,GAAIC,GAAUH,EAAE,4BACXG,GAAQC,QACXJ,EAAE,wBAAwBK,MAAM,SAASC,GAEvC,GAAK,QADQN,EAAEO,MAAMC,KAAK,UAAUC,MAElC,OAAO,CAGTH,GAAEI,gBACF,IACIC,IADM,GAAIC,MACFC,IAAIF,OACZG,EAAOC,OAAOC,OAAQH,IAAIG,OAAQL,EACtC,IAAK,OAASG,EAAO,CACnB,IAAOC,OAAOE,QAASJ,IAAII,SACzB,OAAO,CAEPH,GAAO,QAIX,GAAII,KAIJ,IAHAlB,EAAE,aAAamB,KAAK,gCAAgCC,KAAM,SAASC,EAAGC,GACpEJ,EAAQK,KAAMC,SAASxB,EAAEsB,GAAOb,MAAO,QAElCS,EAAQd,OACb,OAAO,CAGT,IAAIqB,GAAWZ,IAAIa,OAASb,IAAIc,KAAO,YAAcT,EAAQU,KAAK,KAAO,aAAef,IAAIgB,MAAQ,SAAWf,CAC/GX,GAAQ2B,KAAK,MAAOL,KAKxBzB,EAAE,sBAAsB+B,OAAO,WAC7B/B,EAAE,sBAAsBgC,SAAS,WACjChC,EAAE,4BAA4BgC,SAAS,UACvChC,EAAE,6CAA6CiC,YAMnDpB,IAAIqB,SAAW,SAASC,GAEtB,GADAnC,EAAE,sBAAsBoC,YAAY,WAC/BD,EAAKE,MAER,WADArC,GAAE,cAAcsC,YAAY,UAAUnB,KAAK,KAAKoB,KAAKJ,EAAKK,QAG5D,IAAIC,GAAOzC,EAAE,gBACT0C,EAASD,EAAKtB,KAAK,gBACvBsB,GAAKtB,KAAK,gBAAgBoB,KAAKJ,EAAKK,SACpCxC,EAAEoB,KAAMe,EAAKQ,KAAM,SAAStB,EAAGuB,GAC7BF,EAAMG,OAAOD,KAEfH,EAAKH,YAAY,YAGlBQ","file":"../bulk-exporter.js","sourcesContent":["/**\n * Handle Export Action\n */\n\n/*global YB2: false*/\n\n(function ($) {\n\n  'use strict';\n\n  $(document).ready(function(){\n\n    // Set exporter helper\n    var $iframe = $('iframe[name=\"yb2-export\"]');\n    if ( $iframe.length ) {\n      $('#doaction,#doaction2').click(function(e){\n        var action = $(this).prev('select').val();\n        if ( 'yb2' !== action ) {\n          return true;\n        }\n        // Do Ajax.\n        e.preventDefault();\n        var now = new Date();\n        var today = YB2.today;\n        var date = window.prompt( YB2.prompt, today );\n        if ( null === date ) {\n          if ( ! window.confirm( YB2.confirm ) ) {\n            return false;\n          } else {\n            date = 'false';\n          }\n        }\n        // Grab post ids\n        var postIds = [];\n        $('#the-list').find('input[name=\"post[]\"]:checked').each( function(i, input){\n          postIds.push( parseInt($(input).val(), 10) );\n        });\n        if ( ! postIds.length ) {\n          return true;\n        }\n        // Set timer\n        var endpoint = YB2.export + YB2.glue + 'post_ids=' + postIds.join(',') + '&_wpnonce=' + YB2.nonce + '&date=' + date;\n        $iframe.attr('src', endpoint);\n      });\n    }\n\n    // Set form helper\n    $('#yb2-file-uploader').submit(function(){\n      $('.yb2-result-window').addClass('loading');\n      $('.yb2-success, .yb2-error').addClass('toggle');\n      $('.yb2-messages, .yb2-message, .yb2-error p').empty();\n    });\n\n  });\n\n\n  YB2.callback = function(json) {\n    $('.yb2-result-window').removeClass('loading');\n    if ( json.error ) {\n      $('.yb2-error').toggleClass('toggle').find('p').html(json.message);\n      return;\n    }\n    var $msg = $('.yb2-success');\n    var $list  = $msg.find('.yb2-messages');\n    $msg.find('.yb2-message').html(json.message);\n    $.each( json.data, function(i, li){\n      $list.append(li);\n    });\n    $msg.toggleClass('toggle');\n  }\n\n})(jQuery);\n"]}